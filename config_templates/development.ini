# =========================================================================
# Development Configuration Template
# =========================================================================
# This configuration is optimized for development environments with:
# - Enhanced debugging and monitoring
# - Lower thresholds for testing
# - Detailed logging and profiling enabled
# - Relaxed performance constraints
# =========================================================================

# Basic application settings
log_source_type = "mongodb"
log_input_path = "data/sample_logs.txt"
reader_state_path = "data/reader_state.dat"
allowlist_path = "data/allowlist.txt"
alerts_to_stdout = true
alerts_to_file = true
alert_output_path = "data/alerts_dev.json"

# Development-friendly alert settings
alert_throttle_duration_seconds = 60  # Shorter throttling for testing
alert_throttle_max_alerts = 20        # More alerts for debugging

# State management for development
state_persistence_enabled = true
state_file_path = "data/engine_state_dev.dat"
state_save_interval_events = 1000     # More frequent saves for debugging
state_pruning_enabled = true
state_ttl_seconds = 3600              # Shorter TTL for development
state_prune_interval_events = 5000

# Development monitoring
live_monitoring_enabled = true
live_monitoring_sleep_seconds = 2

# ML data collection for development
ml_data_collection_enabled = true
ml_data_collection_path = "data/training_features_dev.csv"

[Tier1]
enabled = true
# Lower thresholds for development testing
max_requests_per_ip_in_window = 50    # Lower for testing
max_failed_logins_per_ip_in_window = 5
# Development-friendly scoring
score_missing_ua = 2.0                # Lower scores for testing
score_outdated_browser = 5.0
score_known_bad_ua = 50.0
score_headless_browser = 20.0
score_ua_cycling = 40.0
score_suspicious_path = 60.0
score_sensitive_path_new_ip = 40.0

[Tier2]
enabled = true
z_score_threshold = 2.5               # Lower threshold for development
min_samples_for_z_score = 10          # Fewer samples required

[Tier3]
enabled = false                       # Disabled for development by default
model_path = "models/isolation_forest.onnx"
anomaly_score_threshold = 0.4         # Lower threshold
automated_retraining_enabled = false

[Alerting]
file_enabled = true
syslog_enabled = false                # Disabled for development
http_enabled = false

[ThreatIntel]
enabled = false                       # Disabled for development

[MongoLogSource]
uri = "mongodb://localhost:27017"
database = "logs_dev"
collection = "access_dev"
timestamp_field_name = "timestamp"

[Logging]
# Enhanced logging for development
console_enabled = true
file_enabled = true
file_path = "data/logs/anomaly_detector_dev.log"
max_file_size_mb = 50
max_files = 5
log_level = "DEBUG"                   # Debug level for development
json_format = false                   # Human-readable format
enable_function_logging = true
enable_performance_logging = true
enable_memory_logging = true

[Monitoring]
enable_deep_timing = true             # Enable for development
web_server_host = "127.0.0.1"        # Localhost only for dev
web_server_port = 9090

[Prometheus]
enabled = true
host = "127.0.0.1"                    # Localhost only for dev
port = 9090
metrics_path = "/metrics"
health_path = "/health"
scrape_interval_seconds = 10          # More frequent for development
replace_web_server = false
max_metrics_age_seconds = 180         # Shorter retention for dev

[DynamicLearning]
enabled = true
learning_window_hours = 4             # Shorter window for development
confidence_threshold = 0.85           # Lower confidence for faster learning
min_samples_for_learning = 20         # Fewer samples required
seasonal_detection_sensitivity = 0.9
baseline_update_interval_seconds = 60 # More frequent updates
enable_manual_overrides = true
threshold_change_max_percent = 100.0  # Allow larger changes for testing

[Tier4]
enabled = false                       # Disabled for development by default
prometheus_url = "http://localhost:9090"
query_timeout_seconds = 10
evaluation_interval_seconds = 30      # More frequent for development
max_concurrent_queries = 5
enable_circuit_breaker = true
circuit_breaker_failure_threshold = 3 # Lower threshold for development

[MemoryManagement]
enabled = true
max_memory_usage_mb = 512             # Lower limit for development
memory_pressure_threshold_mb = 400
enable_object_pooling = true
eviction_check_interval_seconds = 30  # More frequent for development
eviction_threshold_percent = 75.0
enable_memory_compaction = true
state_object_ttl_seconds = 1800       # Shorter TTL for development

[PerformanceMonitoring]
enabled = true
enable_profiling = true               # Enable for development analysis
enable_load_shedding = false          # Disabled for development testing

# Metrics collection settings
metrics_collection_interval_ms = 500  # More frequent collection
max_latency_samples_per_component = 5000

# Relaxed thresholds for development
max_cpu_usage_percent = 90.0
max_memory_usage_bytes = 536870912    # 512MB
max_queue_depth = 5000
max_avg_latency_ms = 2000
max_error_rate_percent = 10.0

# Load shedding (disabled by default for dev)
moderate_load_shed_percentage = 5.0
high_load_shed_percentage = 15.0
critical_load_shed_percentage = 30.0

monitoring_loop_interval_seconds = 2  # More frequent monitoring

# Enhanced profiling for development
enable_function_profiling = true
max_profile_samples_per_function = 2000
profile_report_interval_seconds = 120

# Performance reporting
enable_performance_reports = true
performance_report_path = "data/performance_report_dev.csv"
performance_report_interval_seconds = 30

[ErrorHandling]
enabled = true

# Circuit breaker - more sensitive for development
enable_circuit_breaker = true
circuit_breaker_failure_threshold = 3  # Lower threshold
circuit_breaker_timeout_ms = 3000
circuit_breaker_recovery_timeout_ms = 15000

# Aggressive retry for development
enable_error_recovery = true
max_retry_attempts = 5                # More retries for development
initial_retry_delay_ms = 50
max_retry_delay_ms = 2000
retry_backoff_multiplier = 1.5

# Early degradation for development testing
enable_graceful_degradation = true
cpu_threshold_for_degradation = 80.0
memory_threshold_for_degradation_mb = 450
queue_depth_threshold_for_degradation = 8000
error_rate_threshold_for_degradation = 8.0

# Recovery strategies optimized for development
default_recovery_strategy = "RETRY"
prometheus_recovery_strategy = "FALLBACK"
database_recovery_strategy = "RETRY"
file_io_recovery_strategy = "FALLBACK"
network_recovery_strategy = "RETRY"

# Enhanced error tracking for development
enable_error_rate_limiting = false    # Disabled to see all errors
max_errors_per_minute = 1000
error_burst_limit = 100

# Detailed recovery monitoring
recovery_statistics_interval_seconds = 30
log_recovery_attempts = true
recovery_log_level = "DEBUG"          # Debug level for development
